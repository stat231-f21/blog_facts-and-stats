---
title: "Maps"
author: "Diego Duckenfield-Lopez"
date: "11/8/2021"
output: html_document
---

```{r setup, include=FALSE}
library(readxl)
library(mdsr)
library(tidyverse)
library(dplyr)
library(knitr)
library(ggplot2)
library(janitor)
library(viridis)
library(sf)
```

```{r, eval = TRUE}
# Incarceration Trends
incarceration_trends <-read_csv("incarceration_trends.csv")
incarceration_trends_jail_jurisdiction <-read_csv("incarceration_trends_jail_jurisdiction.csv")
head(incarceration_trends)
head(incarceration_trends_jail_jurisdiction)
```

```{r pressure, echo=FALSE}
#Create dataset with coordinate information for states
state_map <- maps::map("state", plot = FALSE, fill = TRUE) %>% 
  st_as_sf()

state_info <- data.frame(Region = state.region,
                         # Match state variable name in map data
                         ID = tolower(state.name), 
                         # Match state variable name in summary data
                         State = state.abb)

#Create dataset with coordinate information for counties
county_map <- maps::map("county", plot = FALSE, fill = TRUE) %>% 
  st_as_sf() 

#delete state name from county name
county_map <-county_map %>%
  separate(ID, c("state","county"), sep = ',')

county_map


state_map <- maps::map("state", plot = FALSE, fill = TRUE) %>% 
  st_as_sf()

incarceration_trends<- incarceration_trends %>%
  separate(county_name, c("county",NA), sep = " ")

incarceration_trends_2003<-incarceration_trends %>% filter(year==2003, state!="AK", state!="HI" )%>%
  mutate(ID=tolower(incarceration_trends$county))


tail(incarceration_trends_2003)
tail(county_map)

incarceration_map_2003 <- county_map %>% 
  left_join(incarceration_trends_2003)
  

ggplot(data = state_map) +
  geom_sf(data=county_map, fill= "lightgrey", color = "white")+
  geom_sf(fill = NA, color = "black") +
  theme_void()
ggplot(incarceration_trends, aes(fill = total_pop)) +
geom_sf() +
  scale_fill_viridis(option = "magma", direction = -1) +
  theme_void()
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
